!function(){function e(e,n){e.when("/",{templateUrl:"/home/home.view.html",controller:"homeCtrl"}).when("/register",{templateUrl:"/authentication/register/register.view.html",controller:"registerCtrl"}).when("/login",{templateUrl:"/authentication/login/login.view.html",controller:"loginCtrl"}).when("/profile",{templateUrl:"/profile/profile/profile.view.html",controller:"profileCtrl"}).otherwise({redirectTo:"/"}),n.html5Mode(!0)}function n(e,n,o){e.$on("$routeChangeStart",function(e,t,r){"/profile"!==n.path()||o.isLoggedIn()||n.path("/")})}angular.module("plan",["ui.bootstrap","ngRoute"]),angular.module("plan").config(["$routeProvider","$locationProvider",e]).run(["$rootScope","$location","authentication",n])}(),function(){function e(){}angular.module("plan").controller("homeCtrl",e)}(),function(){function e(e,n,o){n.credentials={username:"",password:""},n.onSubmit=function(){o.login(n.credentials).error(function(e){alert(e.message)}).then(function(){e.path("/profile")})}}angular.module("plan").controller("loginCtrl",e),e.$inject=["$location","$scope","authentication"]}(),function(){function e(e,n,o){n.errorPresent=!1,n.errorMsg=[],n.credentials={username:"",password:"",confirmPass:""};var t=function(e){console.log("Registration failed due to incorrect field values"),n.errorPresent=!0,n.errorMsg=e.errorMessage};n.onSubmit=function(){console.log("Checking registration..."),o.register(n.credentials).error(t).then(function(){e.path("profile"),console.log("Submitting registration")})}}angular.module("plan").controller("registerCtrl",e),e.$inject=["$location","$scope","authentication"]}(),function(){function e(e,n){e.user={},n.getProfile().success(function(n){e.user=n,console.log(e.user)}).error(function(e){console.log(e)})}angular.module("plan").controller("profileCtrl",e),e.$inject=["$scope","planData"]}(),function(){function e(e,n){var o=function(e){n.localStorage.token=e},t=function(){return n.localStorage.token},r=function(){var e,o=t();return!!o&&(e=o.split(".")[1],e=n.atob(e),e=JSON.parse(e),e.exp>Date.now()/1e3)},i=function(){if(r()){var e=t(),o=e.split(".")[1];return o=n.atob(o),o=JSON.parse(o),{name:o.username}}},l=function(n){return e.post("/api/register",n).success(function(e){o(e.token)})},a=function(n){return e.post("/api/login",n).success(function(e){o(e.token)})},c=function(){n.localStorage.removeItem("token")};return{currentUser:i,saveToken:o,getToken:t,isLoggedIn:r,register:l,login:a,logout:c}}angular.module("plan").service("authentication",e),e.$inject=["$http","$window"]}(),function(){function e(e,n){var o=function(){return e.get("/api/profile",{headers:{Authorization:"Bearer "+n.getToken()}})};return{getProfile:o}}angular.module("plan").service("planData",e),e.$inject=["$http","authentication"]}();